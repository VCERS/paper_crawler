(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{284:function(e,t,r){"use strict";r.r(t),r.d(t,"GetFTRElements",(function(){return h})),r.d(t,"GetFTRSelectors",(function(){return a})),r.d(t,"GetFTRClassList",(function(){return c})),r.d(t,"GetFTRTexts",(function(){return l}));var s,n=r(1),i=r(89),o=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),__decorate=function(e,t,r,s){var n,i=arguments.length,o=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(o=(i<3?n(o):i>3?n(t,r,o):n(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},l=function(e){function Texts(){var t=null!==e&&e.apply(this,arguments)||this;return t.rqvReferenceID="rqv-reference-",t.getFtrReferenceUrl="data-getFTR-reference-url",t.citedByReferencesUrl="data-getFTR-citedby-url",t.consfigs={childList:!0},t.rootMargin="800px 0px 800px 0px",t.threshold=.5,t.citeByNewElementsAmount=100,t}return o(Texts,e),Texts}(i.d),c=function(e){function ClassList(){var t=null!==e&&e.apply(this,arguments)||this;return t.alreadyTriggered="triggered",t}return o(ClassList,e),ClassList}(i.a),a=function(e){function Selectors(){var t=null!==e&&e.apply(this,arguments)||this;return t.articleReferences="article #references",t.articleCitedBy="article .cited-by",t.tabContent="article .tab__content",t.rqvModal="#rqv-container",t.activeRqvItem=".reference:not(.suppressed)",t.wslideReferencesLink='a[data-slide-target=".tab__pane-references"]',t.wslideReferencesWrapper=".w-slide__content",t.rqvReferenceWrapper=".rqv-reference-list",t.citedByNewElementsWrapper=".cited-by__content",t.getFTRElement=".getFTR",t.referencesItem=".references__item",t.citedByItem=".citedByEntry",t}return o(Selectors,e),Selectors}(i.c),h=function(e){function Elements(){return null!==e&&e.apply(this,arguments)||this}return o(Elements,e),Elements}(i.b),d=function(e){function GetFTR(){var t=null!==e&&e.apply(this,arguments)||this;return t.citeByLoadingCount=0,t.isObservedData={articleReferences:!1,articleCitedBy:!1,rightTabReferences:!1,rqvModal:!1,wslideReferences:!1},t}return o(GetFTR,e),GetFTR.prototype.initialize=function(){e.prototype.initialize.call(this),this.modifyMethods(),this.fetchAll()},GetFTR.prototype.referencesTab=function(){},GetFTR.prototype.addEventListeners=function(){this.elements.wslideReferencesLink=this.domUtils.getElement(this.selectors.wslideReferencesLink),this.domUtils.addEventListener(this.elements.wslideReferencesLink,"click",this.referencesWslideTab.bind(this))},GetFTR.prototype.referencesRqvShowAllLink=function(){if(!this.isObservedData.rqvModal){this.isObservedData.rqvModal=!0,this.elements.rqvReferenceWrapper=this.domUtils.getElement(this.selectors.rqvReferenceWrapper);var e=this.domUtils.getElements(this.selectors.getFTRElement,this.elements.rqvReferenceWrapper);e.length&&this.setIntersectionObserver(e,this.selectors.referencesItem,!0,4,this.elements.rqvReferenceWrapper)}},GetFTR.prototype.referencesWslideTab=function(){if(!this.isObservedData.wslideReferences){this.isObservedData.wslideReferences=!0,this.elements.wslideReferencesWrapper=this.domUtils.getElement(this.selectors.wslideReferencesWrapper);var e=this.domUtils.getElements(this.selectors.getFTRElement,this.elements.wslideReferencesWrapper);e.length&&this.setIntersectionObserver(e,this.selectors.referencesItem)}},GetFTR.prototype.observeNewCitedByElements=function(){this.elements.citedByNewElementsWrapper=this.domUtils.getElement(this.selectors.citedByNewElementsWrapper),this.citeByLoadingCount++;var e=this.domUtils.getElements(this.selectors.getFTRElement,this.elements.citedByNewElementsWrapper).slice(this.citeByLoadingCount*this.texts.citeByNewElementsAmount);e.length&&this.setIntersectionObserver(e,this.selectors.citedByItem)},GetFTR.prototype.fetchAll=function(){var e=this.domUtils.getElements(this.selectors.getFTRElement,this.elements.articleReferences),t=this.domUtils.getElements(this.selectors.getFTRElement,this.elements.articleCitedBy),r=this.domUtils.getElements(this.selectors.getFTRElement,this.elements.tabContent);(null==e?void 0:e.length)&&!this.isObservedData.articleReferences&&(this.isObservedData.articleReferences=!0,this.setIntersectionObserver(e,this.selectors.referencesItem)),(null==t?void 0:t.length)&&!this.isObservedData.articleCitedBy&&(this.isObservedData.articleCitedBy=!0,this.setIntersectionObserver(t,this.selectors.citedByItem)),(null==r?void 0:r.length)&&!this.isObservedData.rightTabReferences&&(this.isObservedData.rightTabReferences=!0,this.setIntersectionObserver(r,this.selectors.referencesItem,!0,2))},GetFTR.prototype.getDataDoi=function(e,t,r){var s=this,n=this.linksCount/2,i=e.indexOf(t),o=Math.max(0,i-n),l=Math.min(e.length-1,i+n),c=e.slice(o,l+1).filter((function(e){return!e.classList.contains(s.classList.alreadyTriggered)})).map((function(e){return e.classList.add(s.classList.alreadyTriggered),e}));return null==c?void 0:c.map((function(e){var t;return null===(t=e.closest(r))||void 0===t?void 0:t.getAttribute("data-doi")})).filter(Boolean)},GetFTR.prototype.setIntersectionObserver=function(e,t,r,s,n){var i=this;void 0===r&&(r=!1);var o={rootMargin:this.texts.rootMargin,root:n||null,threshold:this.texts.threshold},l=new IntersectionObserver((function(r){r.forEach((function(r){if(r.isIntersecting){var s=i.getDataDoi(e,r.target,t),n=i.setProductConfigs(r.target),o=n.apiUrl,c=n.source;s.length&&i.fetchData(s,o,c,l,r.target),!s.length&&i.unobserveTarget(l,r.target)}}))}),o);this.IntersectionObserverDistributer(e,l,r,s)},GetFTR.prototype.IntersectionObserverDistributer=function(e,t,r,s){for(var n=r?Math.floor(this.linksCount/s):this.linksCount,i=0;i<e.length;i++)0!==i&&i%n!=0&&i!==e.length-1||t.observe(e[i])},GetFTR.prototype.setProductConfigs=function(e){var t,r=e.closest(this.selectors.articleReferences),s=e.closest(this.selectors.articleCitedBy),n=e.closest(this.selectors.tabContent),i=e.closest(this.selectors.wslideReferencesWrapper),o=e.closest(this.selectors.rqvReferenceWrapper),l=this.elements.article.getAttribute(this.texts.getFtrReferenceUrl);return s&&(l=this.elements.article.getAttribute(this.texts.citedByReferencesUrl),t=this.elements.articleCitedBy),r&&(t=this.elements.articleReferences),n&&(t=this.elements.tabContent),i&&(t=this.elements.wslideReferencesWrapper),o&&(t=this.elements.rqvReferenceWrapper),{apiUrl:l,source:t}},GetFTR.prototype.unobserveTarget=function(e,t){e.unobserve(t)},GetFTR.prototype.replaceIdToRqvId=function(e){var t=this;return"#"+e.replace(/^(\D+)|\D/g,(function(e,r){return r?t.texts.rqvReferenceID:""}))},GetFTR.prototype.getSelectedReferences=function(e){var t=this,r=(null==e?void 0:e.split(" ")).map((function(e){return t.replaceIdToRqvId(e)})).map((function(e){return t.domUtils.getElement(e)})).map((function(e){return t.domUtils.getElements(t.selectors.getFTRPlaceholder,e)})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){var t;return null===(t=null==e?void 0:e.closest("[data-doi]"))||void 0===t?void 0:t.getAttribute("data-doi")})).filter(Boolean);if(this.referencesRqvShowAllLink(),null==r?void 0:r.length){var s=this.domUtils.getElement(this.selectors.rqvModal),n=this.elements.article.getAttribute(this.texts.getFtrReferenceUrl);this.fetchData(r,n,s)}},GetFTR.prototype.modifyMethods=function(){this.fetchData=function(e,t,r,s,n){var i=this,o={pubDoi:this.texts.doi,associatedCitations:e,requestSource:this.texts.requestSource};fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(e){s&&i.unobserveTarget(s,n),e.forEach((function(e){var t,s=r;i.elements.getFTRWrapper=null==s?void 0:s.querySelectorAll('[data-doi="'+e.doi+'"]'),null===(t=i.elements.getFTRWrapper)||void 0===t||t.forEach((function(t){i.elements.getFTRPlaceholder=null==t?void 0:t.querySelector(i.selectors.getFTRPlaceholder),i.isEntitlement(e),i.getFTRContentEmpty(),i.removePlaceholder()}))}))})).catch((function(e){console.error("Error:",e)}))},this.getFTRButton=function(e){var t,r,s=!1,n="",i="object"==typeof e,o=i?e.label:"View",l=i?e.url:e,c=!(!i||!e.tooltip)&&e.tooltip,a="maybe"===e.entitled;i&&("yes"===e.entitled||a&&"vor"===e.type)?(s=!0,n="icon-getFTR-na"):i&&"no"===e.entitled&&"av"===e.type&&(s=!0,n="icon-getFTR-av"),r=s?'<i aria-hidden="true" class="'+n+'"></i>':"",this.texts.getFTRButton='<a href="'+l+'"  aria-label="'+(c||o)+'" target="_blank" data-tooltip="'+c+'" class="getFTR__btn '+(c?"getFTR__tooltip":"")+" "+(a?"maybe":"")+'"  tabindex="0">\n                   '+r+"\n                   "+o+"\n                </a>",null===(t=this.elements.getFTRPlaceholder)||void 0===t||t.insertAdjacentHTML("afterbegin",this.texts.getFTRButton)}},GetFTR=__decorate([Object(n.c)(a,h,c,l)],GetFTR)}(i.e);t.default=d}}]);
//# sourceMappingURL=6-d3cb2ae43c675acbb6b0.js.map